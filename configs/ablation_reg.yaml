# MuSAE-Inv Regularisation Sweep Configuration
# Sweeps MuSAE C parameter to study sparsity-accuracy trade-off

seed: 42
device: "cuda"

model_id: "google/gemma-2-2b"
torch_dtype: "bfloat16"
attn_implementation: "eager"

sae_release: "gemma-scope-2b-pt-res-canonical"
target_layers: [6, 12, 18, 25]
sae_width: 16384

icfs_top_k: 128

# ── Regularisation sweep ──
# Override musae_C via command line: --musae-C {value}
# Sweep values: [0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0]
musae_C: 0.3
musae_solver: "saga"
musae_penalty: "l1"
musae_max_iter: 5000
musae_class_weight: "balanced"
n_dial_train: 500

n_qa: 10000
n_dial: 1000
n_summ: 1000
n_tqa: 817
n_cf_qa: 3000
n_cf_dial: 1500
n_cf_summ: 1500
train_ratio: 0.7
val_ratio: 0.15

max_length: 256
batch_size: 16

output_dir: "./outputs/ablation_reg"
force_recompute_feats: false
force_recompute_icfs: false
